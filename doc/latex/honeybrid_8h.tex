\section{honeybrid.h File Reference}
\label{honeybrid_8h}\index{honeybrid.h@{honeybrid.h}}
{\tt \#include $<$pcap.h$>$}\par
\subsection*{Defines}
\begin{CompactItemize}
\item 
\#define {\bf VERSION}~\char`\"{}1.0\char`\"{}
\item 
\#define {\bf PIDFILE}~\char`\"{}/var/run/honeybrid.pid\char`\"{}
\item 
\#define {\bf G\_\-STATIC\_\-RW\_\-LOCK\_\-INIT}~\{ G\_\-STATIC\_\-MUTEX\_\-INIT, NULL, NULL, 0, FALSE, 0, 0 \}
\item 
\#define {\bf G\_\-THREADS\_\-ENABLED}
\item 
\#define {\bf DESTSIZE}~15
\item 
\#define {\bf CONF\_\-MAX\_\-LINE}~1024
\item 
\#define {\bf RESET\_\-HIH}~0
\item 
\#define {\bf BUFSIZE}~2048
\item 
\#define {\bf PAYLOADSIZE}~0xffff
\end{CompactItemize}
\subsection*{Functions}
\begin{CompactItemize}
\item 
int {\bf daemon} (int, int)
\item 
int {\bf yyparse} (void)
\end{CompactItemize}
\subsection*{Variables}
\begin{CompactItemize}
\item 
FILE $\ast$ {\bf yyin} = (FILE $\ast$) 0
\item 
int {\bf running}
\item 
GThread $\ast$ {\bf thread\_\-clean}
\item 
GThread $\ast$ {\bf thread\_\-de}
\end{CompactItemize}


\subsection{Define Documentation}
\index{honeybrid.h@{honeybrid.h}!BUFSIZE@{BUFSIZE}}
\index{BUFSIZE@{BUFSIZE}!honeybrid.h@{honeybrid.h}}
\subsubsection[{BUFSIZE}]{\setlength{\rightskip}{0pt plus 5cm}\#define BUFSIZE~2048}\label{honeybrid_8h_eca034f67218340ecb2261a22c2f3dcd}


use by NF\_\-QUEUE to set the data size of received packets 

Referenced by netlink\_\-loop().\index{honeybrid.h@{honeybrid.h}!CONF\_\-MAX\_\-LINE@{CONF\_\-MAX\_\-LINE}}
\index{CONF\_\-MAX\_\-LINE@{CONF\_\-MAX\_\-LINE}!honeybrid.h@{honeybrid.h}}
\subsubsection[{CONF\_\-MAX\_\-LINE}]{\setlength{\rightskip}{0pt plus 5cm}\#define CONF\_\-MAX\_\-LINE~1024}\label{honeybrid_8h_6c6d5e7307f2939e3c568e336bd9c078}


max size of a line in the configuration file \index{honeybrid.h@{honeybrid.h}!DESTSIZE@{DESTSIZE}}
\index{DESTSIZE@{DESTSIZE}!honeybrid.h@{honeybrid.h}}
\subsubsection[{DESTSIZE}]{\setlength{\rightskip}{0pt plus 5cm}\#define DESTSIZE~15}\label{honeybrid_8h_424a6768138cb9b6a13808bdf56aa1fd}


Decision Engine thread enabled

Two strategies: with thread or with libev If USE\_\-LIBEV is defined, the program loops on the main libev loop:\begin{itemize}
\item packets on queue are processed through libev callback\item connection structures are cleaned by libev timer If not, then the program loops on nfqueue:\item packets on queue are processed through nfqueue callback\item connection structures are cleaned by a thread\end{itemize}


max size of an IP address (4$\ast$3 = 12 + 3 dots = 15) \index{honeybrid.h@{honeybrid.h}!G\_\-STATIC\_\-RW\_\-LOCK\_\-INIT@{G\_\-STATIC\_\-RW\_\-LOCK\_\-INIT}}
\index{G\_\-STATIC\_\-RW\_\-LOCK\_\-INIT@{G\_\-STATIC\_\-RW\_\-LOCK\_\-INIT}!honeybrid.h@{honeybrid.h}}
\subsubsection[{G\_\-STATIC\_\-RW\_\-LOCK\_\-INIT}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\_\-STATIC\_\-RW\_\-LOCK\_\-INIT~\{ G\_\-STATIC\_\-MUTEX\_\-INIT, NULL, NULL, 0, FALSE, 0, 0 \}}\label{honeybrid_8h_997477050280f8596d021a62396188c9}


writing lock initialization \index{honeybrid.h@{honeybrid.h}!G\_\-THREADS\_\-ENABLED@{G\_\-THREADS\_\-ENABLED}}
\index{G\_\-THREADS\_\-ENABLED@{G\_\-THREADS\_\-ENABLED}!honeybrid.h@{honeybrid.h}}
\subsubsection[{G\_\-THREADS\_\-ENABLED}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\_\-THREADS\_\-ENABLED}\label{honeybrid_8h_f4cd83b96fc6a35a73d2f4b3636c0595}


Multi-thread safe mode \index{honeybrid.h@{honeybrid.h}!PAYLOADSIZE@{PAYLOADSIZE}}
\index{PAYLOADSIZE@{PAYLOADSIZE}!honeybrid.h@{honeybrid.h}}
\subsubsection[{PAYLOADSIZE}]{\setlength{\rightskip}{0pt plus 5cm}\#define PAYLOADSIZE~0xffff}\label{honeybrid_8h_aee90f93dbe5337de8788188b49f4eb3}


use by NF\_\-QUEUE to set the data size of received packets 

Referenced by netlink\_\-loop().\index{honeybrid.h@{honeybrid.h}!PIDFILE@{PIDFILE}}
\index{PIDFILE@{PIDFILE}!honeybrid.h@{honeybrid.h}}
\subsubsection[{PIDFILE}]{\setlength{\rightskip}{0pt plus 5cm}\#define PIDFILE~\char`\"{}/var/run/honeybrid.pid\char`\"{}}\label{honeybrid_8h_f5fe208f8640c8c789a4d5d5b8ad47f5}


File to store PID 

Referenced by close\_\-all(), and main().\index{honeybrid.h@{honeybrid.h}!RESET\_\-HIH@{RESET\_\-HIH}}
\index{RESET\_\-HIH@{RESET\_\-HIH}!honeybrid.h@{honeybrid.h}}
\subsubsection[{RESET\_\-HIH}]{\setlength{\rightskip}{0pt plus 5cm}\#define RESET\_\-HIH~0}\label{honeybrid_8h_d0d5a4bce41e104aac6b79edbf6481d1}


use to reset (1) or accept (0) connections initiated by HIH \index{honeybrid.h@{honeybrid.h}!VERSION@{VERSION}}
\index{VERSION@{VERSION}!honeybrid.h@{honeybrid.h}}
\subsubsection[{VERSION}]{\setlength{\rightskip}{0pt plus 5cm}\#define VERSION~\char`\"{}1.0\char`\"{}}\label{honeybrid_8h_1c6d5de492ac61ad29aec7aa9a436bbf}


Version (should always be in sync with the content of the VERSION file) 

Referenced by main(), and usage().

\subsection{Function Documentation}
\index{honeybrid.h@{honeybrid.h}!daemon@{daemon}}
\index{daemon@{daemon}!honeybrid.h@{honeybrid.h}}
\subsubsection[{daemon}]{\setlength{\rightskip}{0pt plus 5cm}int daemon (int, \/  int)}\label{honeybrid_8h_a10914f5d815f5943722ae8be203eeff}




Referenced by main().\index{honeybrid.h@{honeybrid.h}!yyparse@{yyparse}}
\index{yyparse@{yyparse}!honeybrid.h@{honeybrid.h}}
\subsubsection[{yyparse}]{\setlength{\rightskip}{0pt plus 5cm}int yyparse (void)}\label{honeybrid_8h_847a2de5c1c28c9d7055a2b89ed7dad7}




We store a pointer to GKeyFile object in the module hash table

We then check if the file exists. Otherwise we create it

If the file exists, we try to load it into memory

\begin{Desc}
\item[{\bf Todo}]free all these structures, and close file descriptor when exiting \end{Desc}


We store a pointer to the module function in the module hash table If the module function isn't defined in \doxyref{get\_\-module()}{p.}{modules_8c_c9236bf17aa49c868c168ecc5320aded}, the application will exit and display an error message

We store a pointer to the module function in the module hash table If the module function isn't defined in \doxyref{get\_\-module()}{p.}{modules_8c_c9236bf17aa49c868c168ecc5320aded}, the application will exit and display an error message 

References YYSTYPE::addr, config, DE\_\-create\_\-tree(), errx(), get\_\-module(), YYSTYPE::gstring, YYSTYPE::hash, LINKTYPE, module, YYSTYPE::number, YYSTYPE::string, YYSTYPE::target, targets, YY\_\-, YY\_\-REDUCE\_\-PRINT, YY\_\-STACK\_\-PRINT, YY\_\-SYMBOL\_\-PRINT, YYABORT, YYACCEPT, YYDPRINTF, YYEMPTY, YYEOF, YYFINAL, YYID, YYINITDEPTH, YYLAST, YYLEX, YYMAXDEPTH, YYNTOKENS, YYPACT\_\-NINF, YYPOPSTACK, YYSIZE\_\-T, YYSTACK\_\-ALLOC, YYSTACK\_\-ALLOC\_\-MAXIMUM, YYSTACK\_\-BYTES, YYSTACK\_\-FREE, YYSTACK\_\-RELOCATE, YYTABLE\_\-NINF, YYTERROR, and YYTRANSLATE.

Referenced by init\_\-parser().

\subsection{Variable Documentation}
\index{honeybrid.h@{honeybrid.h}!running@{running}}
\index{running@{running}!honeybrid.h@{honeybrid.h}}
\subsubsection[{running}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf running}}\label{honeybrid_8h_2f45113638a0b749a8a205d2cd7fb42b}




Referenced by init\_\-variables(), netlink\_\-loop(), and term\_\-signal\_\-handler().\index{honeybrid.h@{honeybrid.h}!thread\_\-clean@{thread\_\-clean}}
\index{thread\_\-clean@{thread\_\-clean}!honeybrid.h@{honeybrid.h}}
\subsubsection[{thread\_\-clean}]{\setlength{\rightskip}{0pt plus 5cm}GThread$\ast$ {\bf thread\_\-clean}}\label{honeybrid_8h_a86912fb7fd6dd270e1af4dce05368f4}




Referenced by close\_\-thread(), and main().\index{honeybrid.h@{honeybrid.h}!thread\_\-de@{thread\_\-de}}
\index{thread\_\-de@{thread\_\-de}!honeybrid.h@{honeybrid.h}}
\subsubsection[{thread\_\-de}]{\setlength{\rightskip}{0pt plus 5cm}GThread$\ast$ {\bf thread\_\-de}}\label{honeybrid_8h_8f8b775e2b1394cb288986ba04db8302}




Referenced by close\_\-thread(), and main().\index{honeybrid.h@{honeybrid.h}!yyin@{yyin}}
\index{yyin@{yyin}!honeybrid.h@{honeybrid.h}}
\subsubsection[{yyin}]{\setlength{\rightskip}{0pt plus 5cm}FILE $\ast$ {\bf yyin} = (FILE $\ast$) 0}\label{honeybrid_8h_87a127afa8f6c307fbfba10390675406}




Referenced by init\_\-parser(), yyget\_\-in(), and yyset\_\-in().