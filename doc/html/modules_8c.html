<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>honeybrid: modules.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>modules.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;err.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;glib.h&gt;</code><br>
<code>#include &lt;glib/gprintf.h&gt;</code><br>
<code>#include &lt;glib/gstdio.h&gt;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &lt;sys/stat.h&gt;</code><br>
<code>#include &lt;fcntl.h&gt;</code><br>
<code>#include &quot;<a class="el" href="modules_8h-source.html">modules.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="log_8h-source.html">log.h</a>&quot;</code><br>

<p>
<div class="dynheader">
Include dependency graph for modules.c:</div>
<div class="dynsection">
<p><center><img src="modules_8c__incl.png" border="0" usemap="#modules.c_map" alt=""></center>
<map name="modules.c_map">
<area shape="rect" href="modules_8h.html" title="modules.h" alt="" coords="440,84,528,111"><area shape="rect" href="log_8h.html" title="log.h" alt="" coords="568,161,619,188"><area shape="rect" href="tables_8h.html" title="tables.h" alt="" coords="421,161,493,188"><area shape="rect" href="types_8h.html" title="types.h" alt="" coords="380,239,447,265"></map>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="modules_8c.html#c5400410e3513d2fbea9b3a2421a2c21">init_modules</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">setup modules that need to be initialized  <a href="#c5400410e3513d2fbea9b3a2421a2c21"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="modules_8c.html#6df156759566c2d091ef852a17e2fa78">run_module</a> (char *module_name, struct <a class="el" href="structmod__args.html">mod_args</a> args)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">test of a new function to run module based on module name (without calling get_module)  <a href="#6df156759566c2d091ef852a17e2fa78"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*)(struct <a class="el" href="structmod__args.html">mod_args</a>)&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="modules_8c.html#c9236bf17aa49c868c168ecc5320aded">get_module</a> (char *modname)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return the module function pointer from name  <a href="#c9236bf17aa49c868c168ecc5320aded"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="modules_8c.html#6192a290b974369920784a792fc1044b">write_backup</a> (char *filename, GKeyFile *data, void *userdata)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function write a module backup memory to a file.  <a href="#6192a290b974369920784a792fc1044b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="modules_8c.html#3f39ac5d36f425de26ef1076cf613315">save_backup_handler</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function handles the automatic saving of modules to external files. It works by checking an array in which modules to save have been registered This array is updated after each module run.  <a href="#3f39ac5d36f425de26ef1076cf613315"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="modules_8c.html#6a6a789efa2db64ed2bbe9b223efb1b1">save_backup</a> (GKeyFile *data, char *filename)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function adds a module backup memory to a queue in order to be written to a file later.  <a href="#6a6a789efa2db64ed2bbe9b223efb1b1"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="c9236bf17aa49c868c168ecc5320aded"></a><!-- doxytag: member="modules.c::get_module" ref="c9236bf17aa49c868c168ecc5320aded" args="(char *modname)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(*)(struct <a class="el" href="structmod__args.html">mod_args</a>) get_module           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>modname</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
return the module function pointer from name 
<p>
get_module <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>modname,:</em>&nbsp;</td><td>module name </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>function pointer to the module </dd></dl>

<p>References <a class="el" href="err_8c-source.html#l00076">errx()</a>, <a class="el" href="log_8h-source.html#l00100">H</a>, <a class="el" href="mod__counter_8c-source.html#l00044">mod_counter()</a>, <a class="el" href="mod__hash_8c-source.html#l00095">mod_hash()</a>, <a class="el" href="mod__random_8c-source.html#l00047">mod_random()</a>, <a class="el" href="mod__source_8c-source.html#l00050">mod_source()</a>, and <a class="el" href="mod__yesno_8c-source.html#l00043">mod_yesno()</a>.</p>

<p>Referenced by <a class="el" href="rules_8c-source.html#l01176">yyparse()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c5400410e3513d2fbea9b3a2421a2c21"></a><!-- doxytag: member="modules.c::init_modules" ref="c5400410e3513d2fbea9b3a2421a2c21" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_modules           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
setup modules that need to be initialized 
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd>create two functions to handle module backup to file:<ul>
<li>a function called by modules to add themselves to a backup queue</li><li>a timer event callback function to process the backup queue periodically, and save backups to files </li></ul>
</dd></dl>
<p>
init_modules 
<p>
create a thread that will save module memory every minute 
<p>References <a class="el" href="err_8c-source.html#l00076">errx()</a>, <a class="el" href="log_8h-source.html#l00100">H</a>, <a class="el" href="mod__hash_8c-source.html#l00074">init_mod_hash()</a>, <a class="el" href="modules_8h-source.html#l00064">module_to_save</a>, and <a class="el" href="modules_8c-source.html#l00141">save_backup_handler()</a>.</p>

<p>Referenced by <a class="el" href="honeybrid_8c-source.html#l01009">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6df156759566c2d091ef852a17e2fa78"></a><!-- doxytag: member="modules.c::run_module" ref="6df156759566c2d091ef852a17e2fa78" args="(char *module_name, struct mod_args args)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void run_module           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>module_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmod__args.html">mod_args</a>&nbsp;</td>
          <td class="paramname"> <em>args</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
test of a new function to run module based on module name (without calling get_module) 
<p>
run_module 
<p>References <a class="el" href="types_8h-source.html#l00212">pkt_struct::conn</a>, <a class="el" href="log_8h-source.html#l00100">H</a>, <a class="el" href="types_8h-source.html#l00173">conn_struct::id</a>, <a class="el" href="mod__control_8c-source.html#l00048">mod_control()</a>, <a class="el" href="mod__counter_8c-source.html#l00044">mod_counter()</a>, <a class="el" href="mod__hash_8c-source.html#l00095">mod_hash()</a>, <a class="el" href="mod__random_8c-source.html#l00047">mod_random()</a>, <a class="el" href="mod__source_8c-source.html#l00050">mod_source()</a>, <a class="el" href="mod__yesno_8c-source.html#l00043">mod_yesno()</a>, <a class="el" href="modules_8h-source.html#l00040">mod_args::node</a>, <a class="el" href="modules_8h-source.html#l00041">mod_args::pkt</a>, and <a class="el" href="modules_8h-source.html#l00058">node::result</a>.</p>

<p>Referenced by <a class="el" href="decision__engine_8c-source.html#l00196">decide()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6a6a789efa2db64ed2bbe9b223efb1b1"></a><!-- doxytag: member="modules.c::save_backup" ref="6a6a789efa2db64ed2bbe9b223efb1b1" args="(GKeyFile *data, char *filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int save_backup           </td>
          <td>(</td>
          <td class="paramtype">GKeyFile *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>filename</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function adds a module backup memory to a queue in order to be written to a file later. 
<p>
save_backup 
<p>References <a class="el" href="log_8h-source.html#l00100">H</a>, and <a class="el" href="modules_8h-source.html#l00064">module_to_save</a>.</p>

<p>Referenced by <a class="el" href="mod__control_8c-source.html#l00048">mod_control()</a>, <a class="el" href="mod__hash_8c-source.html#l00095">mod_hash()</a>, and <a class="el" href="mod__source_8c-source.html#l00050">mod_source()</a>.</p>

</div>
</div><p>
<a class="anchor" name="3f39ac5d36f425de26ef1076cf613315"></a><!-- doxytag: member="modules.c::save_backup_handler" ref="3f39ac5d36f425de26ef1076cf613315" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void save_backup_handler           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function handles the automatic saving of modules to external files. It works by checking an array in which modules to save have been registered This array is updated after each module run. 
<p>
save_backup_handler 
<p>
saving module every 60 seconds 
<p>References <a class="el" href="log_8h-source.html#l00100">H</a>, <a class="el" href="modules_8h-source.html#l00064">module_to_save</a>, <a class="el" href="tables_8h-source.html#l00140">OK</a>, <a class="el" href="tables_8h-source.html#l00039">threading</a>, and <a class="el" href="modules_8c-source.html#l00118">write_backup()</a>.</p>

<p>Referenced by <a class="el" href="modules_8c-source.html#l00054">init_modules()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6192a290b974369920784a792fc1044b"></a><!-- doxytag: member="modules.c::write_backup" ref="6192a290b974369920784a792fc1044b" args="(char *filename, GKeyFile *data, void *userdata)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int write_backup           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GKeyFile *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>userdata</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function write a module backup memory to a file. 
<p>
write_backup 
<p>References <a class="el" href="log_8h-source.html#l00100">H</a>.</p>

<p>Referenced by <a class="el" href="modules_8c-source.html#l00141">save_backup_handler()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Feb 9 10:46:07 2010 for honeybrid by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
