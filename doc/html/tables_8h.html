<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>honeybrid: tables.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>tables.h File Reference</h1><code>#include &lt;glib.h&gt;</code><br>
<code>#include &lt;err.h&gt;</code><br>
<code>#include &quot;<a class="el" href="types_8h-source.html">types.h</a>&quot;</code><br>

<p>
<div class="dynheader">
Include dependency graph for tables.h:</div>
<div class="dynsection">
<p><center><img src="tables_8h__incl.png" border="0" usemap="#tables.h_map" alt=""></center>
<map name="tables.h_map">
<area shape="rect" href="types_8h.html" title="types.h" alt="" coords="337,84,404,111"><area shape="rect" href="modules_8h.html" title="modules.h" alt="" coords="593,161,681,188"><area shape="rect" href="log_8h.html" title="log.h" alt="" coords="664,239,715,265"></map>
</div>

<p>
<div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dynsection">
<p><center><img src="tables_8h__dep__incl.png" border="0" usemap="#tables.hdep_map" alt=""></center>
<map name="tables.hdep_map">
<area shape="rect" href="decision__engine_8h.html" title="decision_engine.h" alt="" coords="56,161,192,188"><area shape="rect" href="decision__engine_8c.html" title="Decision Engine for honeybrid." alt="" coords="301,316,435,343"><area shape="rect" href="honeybrid_8c.html" title="Main File." alt="" coords="128,316,224,343"><area shape="rect" href="rules_8c.html" title="rules.c" alt="" coords="212,239,276,265"><area shape="rect" href="modules_8h.html" title="modules.h" alt="" coords="641,84,729,111"><area shape="rect" href="netcode_8h.html" title="netcode.h" alt="" coords="781,239,867,265"><area shape="rect" href="mod__control_8c.html" title="Source IP based control engine to rate limit high interaction honeypot." alt="" coords="565,316,677,343"><area shape="rect" href="mod__hash_8c.html" title="SHA 1 Module for honeybrid Decision Engine." alt="" coords="701,316,800,343"><area shape="rect" href="mod__random_8c.html" title="RANDOM module for honeybrid Decision Engine." alt="" coords="832,316,949,343"><area shape="rect" href="mod__source_8c.html" title="Source IP based filtering Module for honeybrid Decision Engine." alt="" coords="973,316,1085,343"><area shape="rect" href="netcode_8c.html" title="Network functions file." alt="" coords="1205,316,1288,343"><area shape="rect" href="tables_8c.html" title="Information tables file." alt="" coords="1415,316,1487,343"><area shape="rect" href="mod__counter_8c.html" title="Packet counter Module for honeybrid Decision Engine." alt="" coords="824,161,939,188"><area shape="rect" href="mod__yesno_8c.html" title="mod_yesno.c" alt="" coords="963,161,1069,188"><area shape="rect" href="log_8c.html" title="Log function for honeybrid." alt="" coords="1347,84,1397,111"><area shape="rect" href="pcap__tool_8c.html" title="Pcap function to record communications." alt="" coords="1421,84,1515,111"><area shape="rect" href="types_8h.html" title="types.h" alt="" coords="317,161,384,188"><area shape="rect" href="modules_8c.html" title="modules.c" alt="" coords="509,161,597,188"></map>
</div>

<p>
<a href="tables_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#5b87fb968177c195ba241e5419180932">CONFIG</a>(parameter)&nbsp;&nbsp;&nbsp;config_lookup(parameter)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#eb932625070a9b697fe9c90694f2f114">ICONFIG</a>(parameter)&nbsp;&nbsp;&nbsp;atoi(config_lookup(parameter))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#0aac6c68a5a4eb4d5dbf7f94919de21c">EXT</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">constants to define the origin of a <a class="el" href="structpacket.html">packet</a>  <a href="#0aac6c68a5a4eb4d5dbf7f94919de21c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#4a158269d8c267128d80bcdd26020140">LIH</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#0fcbf8cc2246af3f90016d96e9a34c5f">HIH</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#df770fe2eec438e3758ffe905dbae208">INVALID</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">constants to define the status of a connection  <a href="#df770fe2eec438e3758ffe905dbae208"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#b5889105dcd019008c9448dff61323f6">INIT</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#a1fa38ecfa8a63030e047b700e385b57">DECISION</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#e0089f6dbe83d0c2d26f1a7a2b6a0ae5">REPLAY</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#6ddfdda7a062d10cff4a72b76b44aeb8">FORWARD</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#bd4ee76e030162b25d8d67087cdc5abf">PROXY</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#ed73fe325abb65b0bd60d72c1e0a58e3">DROP</a>&nbsp;&nbsp;&nbsp;6</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#553a124e1d5855773c74cb5561dec040">CONTROL</a>&nbsp;&nbsp;&nbsp;7</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#ba51915c87d64af47fb1cc59348961c9">OK</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#a915e8300da7583ca4d3b00103a7575f">NOK</a>&nbsp;&nbsp;&nbsp;-1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#45ba202b05caf39795aeca91b0ae547e">TIMEOUT</a>&nbsp;&nbsp;&nbsp;-2</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#821c80d03027e02bfbafd41cbe8ce833">test_honeypot_addr</a> (char *testkey, int list)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">compare an IP with a list of honeypot addresses  <a href="#821c80d03027e02bfbafd41cbe8ce833"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#9caa0904c4bad93cec860d3583503e60">lookup_honeypot_addr</a> (gchar *testkey, int list)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return the low/high interaction honeypot currently associated with the low/high interaction honeypot in argument  <a href="#9caa0904c4bad93cec860d3583503e60"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#fd88f5f9b2e1a96f07e2389659a868f8">lookup_proto</a> (int proto)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#1271052cd45b833fffe18a5a71c40fa5">lookup_origin</a> (int origin)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#5a8ba18af40b5d3be70aa2f237a44305">lookup_state</a> (int state)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#c710506076f7d599c11b9ee253507dbf">switch_state</a> (struct <a class="el" href="structconn__struct.html">conn_struct</a> *conn, int new_state)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#e4c96beae9b95707bbfdce40a54201b0">init_pkt</a> (char *nf_packet, struct <a class="el" href="structpkt__struct.html">pkt_struct</a> *pkt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">init the current <a class="el" href="structpacket.html">packet</a> structure with meta-information such as the origin and the number of bytes of data  <a href="#e4c96beae9b95707bbfdce40a54201b0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#4f340e483fb276ceab0a25388e915486">free_pkt</a> (struct <a class="el" href="structpkt__struct.html">pkt_struct</a> *pkt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">free the current <a class="el" href="structpacket.html">packet</a> structure  <a href="#4f340e483fb276ceab0a25388e915486"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#87e9230cc2f45d9b7cf40863772b5e0d">init_conn</a> (struct <a class="el" href="structpkt__struct.html">pkt_struct</a> *pkt, struct <a class="el" href="structconn__struct.html">conn_struct</a> **conn)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">init the current context using the tuples  <a href="#87e9230cc2f45d9b7cf40863772b5e0d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#276fea9304d0e44959fe383a8a015826">store_pkt</a> (struct <a class="el" href="structconn__struct.html">conn_struct</a> *conn, struct <a class="el" href="structpkt__struct.html">pkt_struct</a> *pkt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Store the current <a class="el" href="structpacket.html">packet</a> as part of the connection to replay it later. If this is the first <a class="el" href="structpacket.html">packet</a> of a communication, init its structure in the main B-Tree.  <a href="#276fea9304d0e44959fe383a8a015826"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#2bbe646c052baf99f04a367ef6031d74">clean</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">watchman for the b_tree, wake up every 5 minutes and check every entries  <a href="#2bbe646c052baf99f04a367ef6031d74"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#dcc1ca3626f4f77403029d5955299f79">setup_redirection</a> (struct <a class="el" href="structconn__struct.html">conn_struct</a> *conn)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">called for each connection being redirected to setup and start the redirection process  <a href="#dcc1ca3626f4f77403029d5955299f79"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#1869b6c8d9405c2112744f839582925d">expire_conn</a> (gpointer key, struct <a class="el" href="structconn__struct.html">conn_struct</a> *cur_conn, gint *expiration_delay)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">called for each entry in the B-Tree, if a time value is upper to "expiration_delay" (default is 120 sec) and the connection is not marked as redirected, entry is deleted  <a href="#1869b6c8d9405c2112744f839582925d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#3b99286503ffeeb6930c555c55367455">free_conn</a> (gpointer key, gpointer trash)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">called for each entry in the pointer array, each entry is a key that is deleted from the B-Tree  <a href="#3b99286503ffeeb6930c555c55367455"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#8219bc2fff93a99b039dd539fbbf5477">config_lookup</a> (char *parameter)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">long int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#26611bf7bdbbe2211a3e5f7d66ad657a">mainpid</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">the pid of the main program  <a href="#26611bf7bdbbe2211a3e5f7d66ad657a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#75c2f1acbca6a769d31c693805c1c53f">threading</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">GPtrArray *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#5683838120bba13cc9fe85d804267dee">targets</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">global array of pointers to hold <a class="el" href="structtarget.html">target</a> structures  <a href="#5683838120bba13cc9fe85d804267dee"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">GStaticRWLock&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#a2939ade9165cd2467c80c6b284ef444">rwlock</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">security writing lock for the Binary Tree  <a href="#a2939ade9165cd2467c80c6b284ef444"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">GStaticRWLock&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#6504f1f2dd7c388151a2380811398a55">hihlock</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">security writing lock for the dynamic high interaction redirection table  <a href="#6504f1f2dd7c388151a2380811398a55"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">GHashTable *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#b508e09b6ef625a91048f41cedebf55d">config</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">global hash table that contain the values of the configuration file  <a href="#b508e09b6ef625a91048f41cedebf55d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">GHashTable *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#993107ce3ba9b94d9eb3f712acea9034">module</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">global hash table to hold module paramaters  <a href="#993107ce3ba9b94d9eb3f712acea9034"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">GHashTable *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#bea40e3b3ed9ec760b3c2dacb5b4e459">low_redirection_table</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">global hash table that contain the static correspondance between LIH services et HIH services  <a href="#bea40e3b3ed9ec760b3c2dacb5b4e459"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">GHashTable *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#c78a111b39c6578a9368b4d9222debb2">high_redirection_table</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">global hash table that contain the dynamic correspondance between HIH services et LIH services  <a href="#c78a111b39c6578a9368b4d9222debb2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">GHashTable *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#ac37e3e4a8610192e1fa0a424ebf6a16">low_honeypot_addr</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">global integer table that contains the addresses of the low_interaction honeypots (integer version)  <a href="#ac37e3e4a8610192e1fa0a424ebf6a16"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">GHashTable *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#2c23bad51327c7ddd0c60a9753fecaf5">high_honeypot_addr</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">global integer table that contains the addresses of the high_interaction honeypots (integer version)  <a href="#2c23bad51327c7ddd0c60a9753fecaf5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">GTree *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#36c5baef03ea7485da14b79b82f72015">conn_tree</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Balanced Binary Tree that keep meta informations about active connections.  <a href="#36c5baef03ea7485da14b79b82f72015"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#1244d27273f4a31c1264effc9bb364fa">c_id</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">GPtrArray *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="tables_8h.html#57f24b1e8646b9629e88a1b6ac586173">entrytoclean</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">pointer table for btree cleaning  <a href="#57f24b1e8646b9629e88a1b6ac586173"></a><br></td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="5b87fb968177c195ba241e5419180932"></a><!-- doxytag: member="tables.h::CONFIG" ref="5b87fb968177c195ba241e5419180932" args="(parameter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONFIG          </td>
          <td>(</td>
          <td class="paramtype">parameter&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;config_lookup(parameter)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="553a124e1d5855773c74cb5561dec040"></a><!-- doxytag: member="tables.h::CONTROL" ref="553a124e1d5855773c74cb5561dec040" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL&nbsp;&nbsp;&nbsp;7          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="log_8c-source.html#l00293">connection_log()</a>, <a class="el" href="decision__engine_8c-source.html#l00275">DE_process_packet()</a>, <a class="el" href="tables_8c-source.html#l00358">init_conn()</a>, and <a class="el" href="tables_8c-source.html#l00191">lookup_state()</a>.</p>

</div>
</div><p>
<a class="anchor" name="a1fa38ecfa8a63030e047b700e385b57"></a><!-- doxytag: member="tables.h::DECISION" ref="a1fa38ecfa8a63030e047b700e385b57" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DECISION&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="log_8c-source.html#l00293">connection_log()</a>, <a class="el" href="decision__engine_8c-source.html#l00275">DE_process_packet()</a>, <a class="el" href="tables_8c-source.html#l00191">lookup_state()</a>, and <a class="el" href="tables_8c-source.html#l00934">setup_redirection()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ed73fe325abb65b0bd60d72c1e0a58e3"></a><!-- doxytag: member="tables.h::DROP" ref="ed73fe325abb65b0bd60d72c1e0a58e3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DROP&nbsp;&nbsp;&nbsp;6          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="log_8c-source.html#l00293">connection_log()</a>, <a class="el" href="decision__engine_8c-source.html#l00275">DE_process_packet()</a>, and <a class="el" href="tables_8c-source.html#l00191">lookup_state()</a>.</p>

</div>
</div><p>
<a class="anchor" name="0aac6c68a5a4eb4d5dbf7f94919de21c"></a><!-- doxytag: member="tables.h::EXT" ref="0aac6c68a5a4eb4d5dbf7f94919de21c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EXT&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
constants to define the origin of a <a class="el" href="structpacket.html">packet</a> 
<p>

<p>Referenced by <a class="el" href="netcode_8c-source.html#l00149">forward()</a>, <a class="el" href="tables_8c-source.html#l00358">init_conn()</a>, <a class="el" href="tables_8c-source.html#l00239">init_pkt()</a>, <a class="el" href="tables_8c-source.html#l00174">lookup_origin()</a>, <a class="el" href="netcode_8c-source.html#l00301">replay()</a>, and <a class="el" href="tables_8c-source.html#l00934">setup_redirection()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6ddfdda7a062d10cff4a72b76b44aeb8"></a><!-- doxytag: member="tables.h::FORWARD" ref="6ddfdda7a062d10cff4a72b76b44aeb8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FORWARD&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="log_8c-source.html#l00293">connection_log()</a>, <a class="el" href="tables_8c-source.html#l00191">lookup_state()</a>, <a class="el" href="netcode_8c-source.html#l00301">replay()</a>, and <a class="el" href="tables_8c-source.html#l00934">setup_redirection()</a>.</p>

</div>
</div><p>
<a class="anchor" name="0fcbf8cc2246af3f90016d96e9a34c5f"></a><!-- doxytag: member="tables.h::HIH" ref="0fcbf8cc2246af3f90016d96e9a34c5f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HIH&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="netcode_8c-source.html#l00149">forward()</a>, <a class="el" href="tables_8c-source.html#l00358">init_conn()</a>, <a class="el" href="tables_8c-source.html#l00174">lookup_origin()</a>, <a class="el" href="netcode_8c-source.html#l00301">replay()</a>, and <a class="el" href="tables_8c-source.html#l00672">test_honeypot_addr()</a>.</p>

</div>
</div><p>
<a class="anchor" name="eb932625070a9b697fe9c90694f2f114"></a><!-- doxytag: member="tables.h::ICONFIG" ref="eb932625070a9b697fe9c90694f2f114" args="(parameter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ICONFIG          </td>
          <td>(</td>
          <td class="paramtype">parameter&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;atoi(config_lookup(parameter))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="honeybrid_8c-source.html#l00327">close_all()</a>, and <a class="el" href="honeybrid_8c-source.html#l01009">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b5889105dcd019008c9448dff61323f6"></a><!-- doxytag: member="tables.h::INIT" ref="b5889105dcd019008c9448dff61323f6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INIT&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="log_8c-source.html#l00293">connection_log()</a>, <a class="el" href="decision__engine_8c-source.html#l00275">DE_process_packet()</a>, <a class="el" href="tables_8c-source.html#l00822">expire_conn()</a>, <a class="el" href="tables_8c-source.html#l00358">init_conn()</a>, and <a class="el" href="tables_8c-source.html#l00191">lookup_state()</a>.</p>

</div>
</div><p>
<a class="anchor" name="df770fe2eec438e3758ffe905dbae208"></a><!-- doxytag: member="tables.h::INVALID" ref="df770fe2eec438e3758ffe905dbae208" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INVALID&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
constants to define the status of a connection 
<p>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00358">init_conn()</a>, and <a class="el" href="tables_8c-source.html#l00191">lookup_state()</a>.</p>

</div>
</div><p>
<a class="anchor" name="4a158269d8c267128d80bcdd26020140"></a><!-- doxytag: member="tables.h::LIH" ref="4a158269d8c267128d80bcdd26020140" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIH&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00358">init_conn()</a>, <a class="el" href="tables_8c-source.html#l00727">lookup_honeypot_addr()</a>, <a class="el" href="tables_8c-source.html#l00174">lookup_origin()</a>, <a class="el" href="netcode_8c-source.html#l00270">reset_lih()</a>, and <a class="el" href="tables_8c-source.html#l00672">test_honeypot_addr()</a>.</p>

</div>
</div><p>
<a class="anchor" name="a915e8300da7583ca4d3b00103a7575f"></a><!-- doxytag: member="tables.h::NOK" ref="a915e8300da7583ca4d3b00103a7575f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NOK&nbsp;&nbsp;&nbsp;-1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return code when something when wrong 
<p>Referenced by <a class="el" href="honeybrid_8c-source.html#l00159">close_thread()</a>, <a class="el" href="netcode_8c-source.html#l00149">forward()</a>, <a class="el" href="tables_8c-source.html#l00339">free_pkt()</a>, <a class="el" href="log_8c-source.html#l00099">honeylog()</a>, <a class="el" href="tables_8c-source.html#l00358">init_conn()</a>, <a class="el" href="tables_8c-source.html#l00239">init_pkt()</a>, <a class="el" href="honeybrid_8c-source.html#l00778">netlink_loop()</a>, <a class="el" href="netcode_8c-source.html#l00301">replay()</a>, <a class="el" href="netcode_8c-source.html#l00214">reply_reset()</a>, <a class="el" href="netcode_8c-source.html#l00270">reset_lih()</a>, <a class="el" href="netcode_8c-source.html#l00087">send_raw()</a>, <a class="el" href="tables_8c-source.html#l00934">setup_redirection()</a>, <a class="el" href="honeybrid_8c-source.html#l00362">term_signal_handler()</a>, <a class="el" href="netcode_8c-source.html#l00405">test_expected()</a>, and <a class="el" href="tables_8c-source.html#l00672">test_honeypot_addr()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ba51915c87d64af47fb1cc59348961c9"></a><!-- doxytag: member="tables.h::OK" ref="ba51915c87d64af47fb1cc59348961c9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OK&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return code when everything's fine 
<p>Referenced by <a class="el" href="tables_8c-source.html#l00892">clean()</a>, <a class="el" href="honeybrid_8c-source.html#l00316">close_target()</a>, <a class="el" href="decision__engine_8c-source.html#l00275">DE_process_packet()</a>, <a class="el" href="decision__engine_8c-source.html#l00423">DE_submit_packet()</a>, <a class="el" href="netcode_8c-source.html#l00386">define_expected_data()</a>, <a class="el" href="netcode_8c-source.html#l00149">forward()</a>, <a class="el" href="tables_8c-source.html#l00339">free_pkt()</a>, <a class="el" href="netcode_8c-source.html#l00361">hb_ip_checksum()</a>, <a class="el" href="log_8c-source.html#l00099">honeylog()</a>, <a class="el" href="tables_8c-source.html#l00358">init_conn()</a>, <a class="el" href="tables_8c-source.html#l00239">init_pkt()</a>, <a class="el" href="netcode_8c-source.html#l00457">init_raw_sockets()</a>, <a class="el" href="honeybrid_8c-source.html#l00449">init_variables()</a>, <a class="el" href="honeybrid_8c-source.html#l01009">main()</a>, <a class="el" href="honeybrid_8c-source.html#l00778">netlink_loop()</a>, <a class="el" href="netcode_8c-source.html#l00301">replay()</a>, <a class="el" href="modules_8c-source.html#l00141">save_backup_handler()</a>, <a class="el" href="netcode_8c-source.html#l00087">send_raw()</a>, <a class="el" href="tables_8c-source.html#l00934">setup_redirection()</a>, <a class="el" href="tables_8c-source.html#l00794">store_pkt()</a>, <a class="el" href="tables_8c-source.html#l00223">switch_state()</a>, <a class="el" href="netcode_8c-source.html#l00475">tcp_checksum()</a>, <a class="el" href="netcode_8c-source.html#l00405">test_expected()</a>, <a class="el" href="tables_8c-source.html#l00672">test_honeypot_addr()</a>, and <a class="el" href="netcode_8c-source.html#l00374">udp_checksum()</a>.</p>

</div>
</div><p>
<a class="anchor" name="bd4ee76e030162b25d8d67087cdc5abf"></a><!-- doxytag: member="tables.h::PROXY" ref="bd4ee76e030162b25d8d67087cdc5abf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROXY&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="log_8c-source.html#l00293">connection_log()</a>, <a class="el" href="decision__engine_8c-source.html#l00275">DE_process_packet()</a>, <a class="el" href="tables_8c-source.html#l00358">init_conn()</a>, and <a class="el" href="tables_8c-source.html#l00191">lookup_state()</a>.</p>

</div>
</div><p>
<a class="anchor" name="e0089f6dbe83d0c2d26f1a7a2b6a0ae5"></a><!-- doxytag: member="tables.h::REPLAY" ref="e0089f6dbe83d0c2d26f1a7a2b6a0ae5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REPLAY&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="log_8c-source.html#l00293">connection_log()</a>, <a class="el" href="tables_8c-source.html#l00191">lookup_state()</a>, and <a class="el" href="tables_8c-source.html#l00934">setup_redirection()</a>.</p>

</div>
</div><p>
<a class="anchor" name="45ba202b05caf39795aeca91b0ae547e"></a><!-- doxytag: member="tables.h::TIMEOUT" ref="45ba202b05caf39795aeca91b0ae547e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIMEOUT&nbsp;&nbsp;&nbsp;-2          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return code when something took too much time 
</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="2bbe646c052baf99f04a367ef6031d74"></a><!-- doxytag: member="tables.h::clean" ref="2bbe646c052baf99f04a367ef6031d74" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clean           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
watchman for the b_tree, wake up every 5 minutes and check every entries 
<p>
clean 
<p>
wake up every second<p>
init the table<p>
call the clean function for each value, delete the value if TRUE is returned<p>
remove each key listed from the btree<p>
free the array 
<p>References <a class="el" href="tables_8h-source.html#l00053">config</a>, <a class="el" href="tables_8h-source.html#l00088">conn_tree</a>, <a class="el" href="tables_8h-source.html#l00093">entrytoclean</a>, <a class="el" href="tables_8c-source.html#l00822">expire_conn()</a>, <a class="el" href="tables_8c-source.html#l00876">free_conn()</a>, <a class="el" href="tables_8h-source.html#l00140">OK</a>, and <a class="el" href="tables_8h-source.html#l00039">threading</a>.</p>

<p>Referenced by <a class="el" href="honeybrid_8c-source.html#l00392">switch_clean()</a>.</p>

</div>
</div><p>
<a class="anchor" name="8219bc2fff93a99b039dd539fbbf5477"></a><!-- doxytag: member="tables.h::config_lookup" ref="8219bc2fff93a99b039dd539fbbf5477" args="(char *parameter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* config_lookup           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>parameter</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
config_lookup /brief lookup values from the config hash table. Make sure the required value is present 
<p>References <a class="el" href="tables_8h-source.html#l00053">config</a>, and <a class="el" href="err_8c-source.html#l00076">errx()</a>.</p>

</div>
</div><p>
<a class="anchor" name="1869b6c8d9405c2112744f839582925d"></a><!-- doxytag: member="tables.h::expire_conn" ref="1869b6c8d9405c2112744f839582925d" args="(gpointer key, struct conn_struct *cur_conn, gint *expiration_delay)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int expire_conn           </td>
          <td>(</td>
          <td class="paramtype">gpointer&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structconn__struct.html">conn_struct</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint *&nbsp;</td>
          <td class="paramname"> <em>expiration_delay</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
called for each entry in the B-Tree, if a time value is upper to "expiration_delay" (default is 120 sec) and the connection is not marked as redirected, entry is deleted 
<p>
expire_conn <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>key,a</em>&nbsp;</td><td>pointer to the current B-Tree key value </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>conn,a</em>&nbsp;</td><td>pointer to the current B-Tree associated value </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>expiration_delay</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>FALSE, to continue to traverse the <a class="el" href="structtree.html">tree</a> (if TRUE is returned, traversal is stopped) </dd></dl>

<p>
output final statistics about the connection<p>
lock the structure, this will never be unlocked<p>
remove the singly linked lists<p>
g_free(conn-&gt;key_hih); free(conn-&gt;decision_rule);<p>
list the entry for later removal 
<p>References <a class="el" href="types_8h-source.html#l00171">conn_struct::access_time</a>, <a class="el" href="types_8h-source.html#l00177">conn_struct::BUFFER</a>, <a class="el" href="log_8c-source.html#l00293">connection_log()</a>, <a class="el" href="types_8h-source.html#l00192">conn_struct::decision_rule</a>, <a class="el" href="tables_8h-source.html#l00093">entrytoclean</a>, <a class="el" href="tables_8c-source.html#l00339">free_pkt()</a>, <a class="el" href="log_8h-source.html#l00100">H</a>, <a class="el" href="types_8h-source.html#l00173">conn_struct::id</a>, <a class="el" href="tables_8h-source.html#l00127">INIT</a>, <a class="el" href="types_8h-source.html#l00165">conn_struct::key_ext</a>, <a class="el" href="types_8h-source.html#l00166">conn_struct::key_lih</a>, <a class="el" href="types_8h-source.html#l00179">conn_struct::lock</a>, and <a class="el" href="types_8h-source.html#l00172">conn_struct::state</a>.</p>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00892">clean()</a>, and <a class="el" href="honeybrid_8c-source.html#l00272">close_conn_tree()</a>.</p>

</div>
</div><p>
<a class="anchor" name="3b99286503ffeeb6930c555c55367455"></a><!-- doxytag: member="tables.h::free_conn" ref="3b99286503ffeeb6930c555c55367455" args="(gpointer key, gpointer trash)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_conn           </td>
          <td>(</td>
          <td class="paramtype">gpointer&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gpointer&nbsp;</td>
          <td class="paramname"> <em>trash</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
called for each entry in the pointer array, each entry is a key that is deleted from the B-Tree 
<p>
free_conn <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>key,a</em>&nbsp;</td><td>pointer to the current B-Tree key value stored in the pointer table </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>trash,user</em>&nbsp;</td><td>data, unused </td></tr>
  </table>
</dl>

<p>References <a class="el" href="tables_8h-source.html#l00088">conn_tree</a>, <a class="el" href="log_8h-source.html#l00100">H</a>, and <a class="el" href="tables_8h-source.html#l00046">rwlock</a>.</p>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00892">clean()</a>, and <a class="el" href="honeybrid_8c-source.html#l00272">close_conn_tree()</a>.</p>

</div>
</div><p>
<a class="anchor" name="4f340e483fb276ceab0a25388e915486"></a><!-- doxytag: member="tables.h::free_pkt" ref="4f340e483fb276ceab0a25388e915486" args="(struct pkt_struct *pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int free_pkt           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpkt__struct.html">pkt_struct</a> *&nbsp;</td>
          <td class="paramname"> <em>pkt</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
free the current <a class="el" href="structpacket.html">packet</a> structure 
<p>
free_pkt <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pkt,:</em>&nbsp;</td><td>struct <a class="el" href="structpkt__struct.html" title="The meta information of a packet stored in the conn_struct connection structure.">pkt_struct</a> to free </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>OK </dd></dl>

<p>References <a class="el" href="types_8h-source.html#l00078">packet::FRAME</a>, <a class="el" href="types_8h-source.html#l00074">packet::ip</a>, <a class="el" href="types_8h-source.html#l00215">pkt_struct::key</a>, <a class="el" href="types_8h-source.html#l00214">pkt_struct::key_dst</a>, <a class="el" href="types_8h-source.html#l00213">pkt_struct::key_src</a>, <a class="el" href="tables_8h-source.html#l00147">NOK</a>, <a class="el" href="tables_8h-source.html#l00140">OK</a>, and <a class="el" href="types_8h-source.html#l00207">pkt_struct::packet</a>.</p>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00822">expire_conn()</a>, and <a class="el" href="netcode_8c-source.html#l00301">replay()</a>.</p>

</div>
</div><p>
<a class="anchor" name="87e9230cc2f45d9b7cf40863772b5e0d"></a><!-- doxytag: member="tables.h::init_conn" ref="87e9230cc2f45d9b7cf40863772b5e0d" args="(struct pkt_struct *pkt, struct conn_struct **conn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_conn           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpkt__struct.html">pkt_struct</a> *&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structconn__struct.html">conn_struct</a> **&nbsp;</td>
          <td class="paramname"> <em>conn</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
init the current context using the tuples 
<p>
init_conn <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pkt,:</em>&nbsp;</td><td>struct <a class="el" href="structpkt__struct.html" title="The meta information of a packet stored in the conn_struct connection structure.">pkt_struct</a> to work with </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>conn,:</em>&nbsp;</td><td>struct <a class="el" href="structconn__struct.html" title="The meta informations of a connection stored in the main Binary Tree.">conn_struct</a> to work with </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 if success, anything else otherwise </dd></dl>

<p>
Get current time to update or create the structure<p>
if key-&gt;str is null, then we have a seg fault! And it can happen if no LIH was found from a HIH-&gt;EXT <a class="el" href="structpacket.html">packet</a>... if ( pkt-&gt;key == NULL ) { g_printerr("%s key is NULL, no valid connection attached\n", <a class="el" href="log_8h.html#ee722791bac86c287527610799a9d221">H(4)</a>); return NOK; }<p>
The key could not be found, so we need to figure out where this <a class="el" href="structpacket.html">packet</a> comes from<p>
Try to match a <a class="el" href="structtarget.html">target</a> with this <a class="el" href="structpacket.html">packet</a><p>
If not, then it means the packets is either originated from a honeypot inside (we control) or from a non supported external host (we drop)<p>
check if the src is in the honeynet<p>
if not, then this <a class="el" href="structpacket.html">packet</a> is for an unconfigured <a class="el" href="structtarget.html">target</a>, we drop it<p>
IPs match, we can proceed<p>
destination address is not the LIH address, so we drop the <a class="el" href="structpacket.html">packet</a> (later we might NAT <dl compact><dt><b><a class="el" href="todo.html#_todo000010">Todo:</a></b></dt><dd>) </dd></dl>
<p>
Init new connection structure<p>
fill the structure<p>
statistics<p>
conn_init-&gt;decision_rule = malloc(512);<p>
insert entry in B-Tree (set up a lock to protect the writing)<p>
free the lock<p>
store new entry in current struct<p>
The key was found in the B-Tree<p>
We store control statistics in the proxy mode<p>
statistics<p>
We update the current connection access time 
<p>References <a class="el" href="types_8h-source.html#l00171">conn_struct::access_time</a>, <a class="el" href="types_8h-source.html#l00177">conn_struct::BUFFER</a>, <a class="el" href="tables_8h-source.html#l00090">c_id</a>, <a class="el" href="types_8h-source.html#l00212">pkt_struct::conn</a>, <a class="el" href="tables_8h-source.html#l00088">conn_tree</a>, <a class="el" href="tables_8h-source.html#l00133">CONTROL</a>, <a class="el" href="types_8h-source.html#l00176">conn_struct::count_data_pkt_from_intruder</a>, <a class="el" href="types_8h-source.html#l00175">conn_struct::count_data_pkt_from_lih</a>, <a class="el" href="types_8h-source.html#l00192">conn_struct::decision_rule</a>, <a class="el" href="types_8h-source.html#l00126">hih_struct::delta</a>, <a class="el" href="types_8h-source.html#l00032">ETHER_HDR_LEN</a>, <a class="el" href="tables_8h-source.html#l00120">EXT</a>, <a class="el" href="types_8h-source.html#l00078">packet::FRAME</a>, <a class="el" href="log_8h-source.html#l00100">H</a>, <a class="el" href="tables_8h-source.html#l00067">high_redirection_table</a>, <a class="el" href="types_8h-source.html#l00180">conn_struct::hih</a>, <a class="el" href="tables_8h-source.html#l00122">HIH</a>, <a class="el" href="types_8h-source.html#l00173">conn_struct::id</a>, <a class="el" href="tables_8h-source.html#l00127">INIT</a>, <a class="el" href="tables_8h-source.html#l00126">INVALID</a>, <a class="el" href="types_8h-source.html#l00194">conn_struct::invalid_problem</a>, <a class="el" href="types_8h-source.html#l00074">packet::ip</a>, <a class="el" href="types_8h-source.html#l00164">conn_struct::key</a>, <a class="el" href="types_8h-source.html#l00215">pkt_struct::key</a>, <a class="el" href="types_8h-source.html#l00214">pkt_struct::key_dst</a>, <a class="el" href="types_8h-source.html#l00165">conn_struct::key_ext</a>, <a class="el" href="types_8h-source.html#l00167">conn_struct::key_hih</a>, <a class="el" href="types_8h-source.html#l00166">conn_struct::key_lih</a>, <a class="el" href="types_8h-source.html#l00213">pkt_struct::key_src</a>, <a class="el" href="tables_8h-source.html#l00121">LIH</a>, <a class="el" href="types_8h-source.html#l00125">hih_struct::lih_syn_seq</a>, <a class="el" href="types_8h-source.html#l00179">conn_struct::lock</a>, <a class="el" href="tables_8h-source.html#l00147">NOK</a>, <a class="el" href="tables_8h-source.html#l00140">OK</a>, <a class="el" href="types_8h-source.html#l00208">pkt_struct::origin</a>, <a class="el" href="types_8h-source.html#l00207">pkt_struct::packet</a>, <a class="el" href="types_8h-source.html#l00168">conn_struct::protocol</a>, <a class="el" href="tables_8h-source.html#l00131">PROXY</a>, <a class="el" href="types_8h-source.html#l00174">conn_struct::replay_id</a>, <a class="el" href="types_8h-source.html#l00193">conn_struct::replay_problem</a>, <a class="el" href="tables_8h-source.html#l00046">rwlock</a>, <a class="el" href="types_8h-source.html#l00210">pkt_struct::size</a>, <a class="el" href="types_8h-source.html#l00170">conn_struct::start_microtime</a>, <a class="el" href="types_8h-source.html#l00169">conn_struct::start_timestamp</a>, <a class="el" href="types_8h-source.html#l00187">conn_struct::stat_byte</a>, <a class="el" href="types_8h-source.html#l00186">conn_struct::stat_packet</a>, <a class="el" href="types_8h-source.html#l00185">conn_struct::stat_time</a>, <a class="el" href="types_8h-source.html#l00172">conn_struct::state</a>, <a class="el" href="types_8h-source.html#l00182">conn_struct::target</a>, <a class="el" href="tables_8h-source.html#l00042">targets</a>, <a class="el" href="types_8h-source.html#l00075">packet::tcp</a>, <a class="el" href="types_8h-source.html#l00189">conn_struct::total_byte</a>, and <a class="el" href="types_8h-source.html#l00188">conn_struct::total_packet</a>.</p>

</div>
</div><p>
<a class="anchor" name="e4c96beae9b95707bbfdce40a54201b0"></a><!-- doxytag: member="tables.h::init_pkt" ref="e4c96beae9b95707bbfdce40a54201b0" args="(char *nf_packet, struct pkt_struct *pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_pkt           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>nf_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structpkt__struct.html">pkt_struct</a> *&nbsp;</td>
          <td class="paramname"> <em>pkt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
init the current <a class="el" href="structpacket.html">packet</a> structure with meta-information such as the origin and the number of bytes of data 
<p>
init_pkt <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nf_packet,:</em>&nbsp;</td><td>The raw <a class="el" href="structpacket.html">packet</a> from the queue </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pkt,:</em>&nbsp;</td><td>The <a class="el" href="structpacket.html">packet</a> metadata structure for this <a class="el" href="structpacket.html">packet</a> </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the origin of the <a class="el" href="structpacket.html">packet</a> </dd></dl>

<p>
TODO: check if it's correctly freed<p>
Create fake ethernet header (used later by bpf_filter)<p>
The most important part is to give to this ethernet header the type "IP protocol"<p>
Add the <a class="el" href="structpacket.html">packet</a> IP header and payload to the <a class="el" href="structpacket.html">packet</a> structure<p>
THOMAS:Let's save memory!<p>
Process TCP packets<p>
key_src is the tuple with the source information {Source IP}:{Source Port}<p>
key_dst is the one with the destination information {Dest IP}:{Dest Port}<p>
Process UDP <a class="el" href="structpacket.html">packet</a><p>
key_src<p>
key_dst<p>
Every other packets are ignored 
<p>References <a class="el" href="types_8h-source.html#l00209">pkt_struct::data</a>, <a class="el" href="types_8h-source.html#l00211">pkt_struct::DE</a>, <a class="el" href="types_8h-source.html#l00032">ETHER_HDR_LEN</a>, <a class="el" href="tables_8h-source.html#l00120">EXT</a>, <a class="el" href="types_8h-source.html#l00078">packet::FRAME</a>, <a class="el" href="log_8h-source.html#l00100">H</a>, <a class="el" href="types_8h-source.html#l00074">packet::ip</a>, <a class="el" href="types_8h-source.html#l00215">pkt_struct::key</a>, <a class="el" href="types_8h-source.html#l00214">pkt_struct::key_dst</a>, <a class="el" href="types_8h-source.html#l00213">pkt_struct::key_src</a>, <a class="el" href="tables_8h-source.html#l00147">NOK</a>, <a class="el" href="tables_8h-source.html#l00140">OK</a>, <a class="el" href="types_8h-source.html#l00208">pkt_struct::origin</a>, <a class="el" href="types_8h-source.html#l00207">pkt_struct::packet</a>, <a class="el" href="types_8h-source.html#l00077">packet::payload</a>, <a class="el" href="types_8h-source.html#l00216">pkt_struct::position</a>, <a class="el" href="types_8h-source.html#l00210">pkt_struct::size</a>, <a class="el" href="types_8h-source.html#l00075">packet::tcp</a>, and <a class="el" href="types_8h-source.html#l00076">packet::udp</a>.</p>

</div>
</div><p>
<a class="anchor" name="9caa0904c4bad93cec860d3583503e60"></a><!-- doxytag: member="tables.h::lookup_honeypot_addr" ref="9caa0904c4bad93cec860d3583503e60" args="(gchar *testkey, int list)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* lookup_honeypot_addr           </td>
          <td>(</td>
          <td class="paramtype">gchar *&nbsp;</td>
          <td class="paramname"> <em>testkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>list</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
return the low/high interaction honeypot currently associated with the low/high interaction honeypot in argument 
<p>
lookup_honeypot_addr<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>the</em>&nbsp;</td><td>key of the honeypot, or honeypot+external host, we want to lookup in the redirection table </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>the</em>&nbsp;</td><td>list we want to look into, either Low or High</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The honeypot IP found, NULL if nothing is found </dd></dl>

<p>
We test which list we want to search<p>
ROBIN 2009-02-25: small hack to include full network definition<p>
get the corresponding hih destination from the low interaction hash table<p>
get the corresponding lih destination from the high interaction hash table<p>
Check first if the high_redirection_table is not null 
<p>References <a class="el" href="log_8h-source.html#l00100">H</a>, <a class="el" href="tables_8h-source.html#l00067">high_redirection_table</a>, <a class="el" href="tables_8h-source.html#l00121">LIH</a>, and <a class="el" href="tables_8h-source.html#l00064">low_redirection_table</a>.</p>

</div>
</div><p>
<a class="anchor" name="1271052cd45b833fffe18a5a71c40fa5"></a><!-- doxytag: member="tables.h::lookup_origin" ref="1271052cd45b833fffe18a5a71c40fa5" args="(int origin)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* lookup_origin           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>origin</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>References <a class="el" href="tables_8h-source.html#l00120">EXT</a>, <a class="el" href="tables_8h-source.html#l00122">HIH</a>, and <a class="el" href="tables_8h-source.html#l00121">LIH</a>.</p>

</div>
</div><p>
<a class="anchor" name="fd88f5f9b2e1a96f07e2389659a868f8"></a><!-- doxytag: member="tables.h::lookup_proto" ref="fd88f5f9b2e1a96f07e2389659a868f8" args="(int proto)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* lookup_proto           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>proto</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="5a8ba18af40b5d3be70aa2f237a44305"></a><!-- doxytag: member="tables.h::lookup_state" ref="5a8ba18af40b5d3be70aa2f237a44305" args="(int state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* lookup_state           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>state</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>References <a class="el" href="tables_8h-source.html#l00133">CONTROL</a>, <a class="el" href="tables_8h-source.html#l00128">DECISION</a>, <a class="el" href="tables_8h-source.html#l00132">DROP</a>, <a class="el" href="tables_8h-source.html#l00130">FORWARD</a>, <a class="el" href="tables_8h-source.html#l00127">INIT</a>, <a class="el" href="tables_8h-source.html#l00126">INVALID</a>, <a class="el" href="tables_8h-source.html#l00131">PROXY</a>, and <a class="el" href="tables_8h-source.html#l00129">REPLAY</a>.</p>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00223">switch_state()</a>.</p>

</div>
</div><p>
<a class="anchor" name="dcc1ca3626f4f77403029d5955299f79"></a><!-- doxytag: member="tables.h::setup_redirection" ref="dcc1ca3626f4f77403029d5955299f79" args="(struct conn_struct *conn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int setup_redirection           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structconn__struct.html">conn_struct</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
called for each connection being redirected to setup and start the redirection process 
<p>
setup_redirection <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>conn,:</em>&nbsp;</td><td>redirected connection metadata </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>OK when done, NOK in case of failure </dd></dl>

<p>
we check for concurrent connections using the same EXT_IP:PORT &lt;-&gt; HIH_IP:PORT<p>
conn-&gt;key_hih = hihaddr;<p>
We then update the status of the connection structure<p>
We reset the LIH<p>
We replay the first packets 
<p>References <a class="el" href="types_8h-source.html#l00123">hih_struct::addr</a>, <a class="el" href="tables_8c-source.html#l00643">addr2int()</a>, <a class="el" href="types_8h-source.html#l00044">target::back_handler</a>, <a class="el" href="types_8h-source.html#l00177">conn_struct::BUFFER</a>, <a class="el" href="tables_8h-source.html#l00128">DECISION</a>, <a class="el" href="netcode_8c-source.html#l00386">define_expected_data()</a>, <a class="el" href="tables_8h-source.html#l00120">EXT</a>, <a class="el" href="tables_8h-source.html#l00130">FORWARD</a>, <a class="el" href="netcode_8c-source.html#l00149">forward()</a>, <a class="el" href="log_8h-source.html#l00100">H</a>, <a class="el" href="tables_8h-source.html#l00067">high_redirection_table</a>, <a class="el" href="types_8h-source.html#l00180">conn_struct::hih</a>, <a class="el" href="types_8h-source.html#l00173">conn_struct::id</a>, <a class="el" href="types_8h-source.html#l00164">conn_struct::key</a>, <a class="el" href="types_8h-source.html#l00165">conn_struct::key_ext</a>, <a class="el" href="types_8h-source.html#l00166">conn_struct::key_lih</a>, <a class="el" href="types_8h-source.html#l00127">hih_struct::lih_addr</a>, <a class="el" href="tables_8h-source.html#l00147">NOK</a>, <a class="el" href="tables_8h-source.html#l00140">OK</a>, <a class="el" href="types_8h-source.html#l00208">pkt_struct::origin</a>, <a class="el" href="types_8h-source.html#l00124">hih_struct::port</a>, <a class="el" href="tables_8h-source.html#l00129">REPLAY</a>, <a class="el" href="types_8h-source.html#l00174">conn_struct::replay_id</a>, <a class="el" href="netcode_8c-source.html#l00270">reset_lih()</a>, <a class="el" href="types_8h-source.html#l00185">conn_struct::stat_time</a>, <a class="el" href="tables_8c-source.html#l00223">switch_state()</a>, and <a class="el" href="types_8h-source.html#l00182">conn_struct::target</a>.</p>

<p>Referenced by <a class="el" href="decision__engine_8c-source.html#l00275">DE_process_packet()</a>.</p>

</div>
</div><p>
<a class="anchor" name="276fea9304d0e44959fe383a8a015826"></a><!-- doxytag: member="tables.h::store_pkt" ref="276fea9304d0e44959fe383a8a015826" args="(struct conn_struct *conn, struct pkt_struct *pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int store_pkt           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structconn__struct.html">conn_struct</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structpkt__struct.html">pkt_struct</a> *&nbsp;</td>
          <td class="paramname"> <em>pkt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Store the current <a class="el" href="structpacket.html">packet</a> as part of the connection to replay it later. If this is the first <a class="el" href="structpacket.html">packet</a> of a communication, init its structure in the main B-Tree. 
<p>
store_pkt function <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pkt,:</em>&nbsp;</td><td>struct <a class="el" href="structpkt__struct.html" title="The meta information of a packet stored in the conn_struct connection structure.">pkt_struct</a> to work with </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>conn,:</em>&nbsp;</td><td>struct <a class="el" href="structconn__struct.html" title="The meta informations of a connection stored in the main Binary Tree.">conn_struct</a> to work with</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the position of the <a class="el" href="structpacket.html">packet</a> in the list in case of success, a negative value if storage has failed </dd></dl>

<p>
Lock the structure<p>
g_static_rw_lock_writer_lock (&amp;conn-&gt;lock);<p>
Append pkt to the singly-linked list of conn<p>
Get the <a class="el" href="structpacket.html">packet</a> position<p>
Unlock the structure<p>
g_static_rw_lock_writer_unlock (&amp;conn-&gt;lock); 
<p>References <a class="el" href="types_8h-source.html#l00177">conn_struct::BUFFER</a>, <a class="el" href="log_8h-source.html#l00100">H</a>, <a class="el" href="types_8h-source.html#l00173">conn_struct::id</a>, <a class="el" href="types_8h-source.html#l00164">conn_struct::key</a>, <a class="el" href="tables_8h-source.html#l00140">OK</a>, and <a class="el" href="types_8h-source.html#l00216">pkt_struct::position</a>.</p>

</div>
</div><p>
<a class="anchor" name="c710506076f7d599c11b9ee253507dbf"></a><!-- doxytag: member="tables.h::switch_state" ref="c710506076f7d599c11b9ee253507dbf" args="(struct conn_struct *conn, int new_state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int switch_state           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structconn__struct.html">conn_struct</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>new_state</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>References <a class="el" href="log_8h-source.html#l00100">H</a>, <a class="el" href="types_8h-source.html#l00173">conn_struct::id</a>, <a class="el" href="tables_8c-source.html#l00191">lookup_state()</a>, <a class="el" href="tables_8h-source.html#l00140">OK</a>, and <a class="el" href="types_8h-source.html#l00172">conn_struct::state</a>.</p>

<p>Referenced by <a class="el" href="decision__engine_8c-source.html#l00275">DE_process_packet()</a>, <a class="el" href="netcode_8c-source.html#l00301">replay()</a>, and <a class="el" href="tables_8c-source.html#l00934">setup_redirection()</a>.</p>

</div>
</div><p>
<a class="anchor" name="821c80d03027e02bfbafd41cbe8ce833"></a><!-- doxytag: member="tables.h::test_honeypot_addr" ref="821c80d03027e02bfbafd41cbe8ce833" args="(char *testkey, int list)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int test_honeypot_addr           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>list</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
compare an IP with a list of honeypot addresses 
<p>
test_honeypot_addr<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>the</em>&nbsp;</td><td>key ip:port of the host we want to test in the list </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>the</em>&nbsp;</td><td>list we want to look into, either Low or High</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 if the key is found in the list, anything else if not </dd></dl>

<p>
We extract the IP from the key<p>
small hack to be able to define matching pattern for multiple IP at once<p>
We convert the IP from char to int<p>
We test which list we want to search<p>
if the IP is detected in the list of low honeypot addresses<p>
We then test by increasing the size of the network progressively:<p>
if the IP is detected in the list of high honeypot addresses 
<p>References <a class="el" href="tables_8c-source.html#l00643">addr2int()</a>, <a class="el" href="tables_8h-source.html#l00073">high_honeypot_addr</a>, <a class="el" href="tables_8h-source.html#l00122">HIH</a>, <a class="el" href="tables_8h-source.html#l00121">LIH</a>, <a class="el" href="tables_8h-source.html#l00070">low_honeypot_addr</a>, <a class="el" href="tables_8h-source.html#l00147">NOK</a>, and <a class="el" href="tables_8h-source.html#l00140">OK</a>.</p>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="1244d27273f4a31c1264effc9bb364fa"></a><!-- doxytag: member="tables.h::c_id" ref="1244d27273f4a31c1264effc9bb364fa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="tables_8h.html#1244d27273f4a31c1264effc9bb364fa">c_id</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00358">init_conn()</a>, and <a class="el" href="honeybrid_8c-source.html#l00449">init_variables()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b508e09b6ef625a91048f41cedebf55d"></a><!-- doxytag: member="tables.h::config" ref="b508e09b6ef625a91048f41cedebf55d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GHashTable* <a class="el" href="tables_8h.html#b508e09b6ef625a91048f41cedebf55d">config</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
global hash table that contain the values of the configuration file 
<p>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00892">clean()</a>, <a class="el" href="honeybrid_8c-source.html#l00206">close_hash()</a>, <a class="el" href="tables_8c-source.html#l01015">config_lookup()</a>, <a class="el" href="log_8c-source.html#l00293">connection_log()</a>, <a class="el" href="pcap__tool_8c-source.html#l00041">create_pcap_filename()</a>, <a class="el" href="honeybrid_8c-source.html#l00449">init_variables()</a>, <a class="el" href="log_8c-source.html#l00163">open_connection_log()</a>, <a class="el" href="log_8c-source.html#l00138">open_debug_log()</a>, <a class="el" href="log_8c-source.html#l00188">rotate_connection_log()</a>, and <a class="el" href="rules_8c-source.html#l01176">yyparse()</a>.</p>

</div>
</div><p>
<a class="anchor" name="36c5baef03ea7485da14b79b82f72015"></a><!-- doxytag: member="tables.h::conn_tree" ref="36c5baef03ea7485da14b79b82f72015" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GTree* <a class="el" href="tables_8h.html#36c5baef03ea7485da14b79b82f72015">conn_tree</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Balanced Binary Tree that keep meta informations about active connections. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>key,each</em>&nbsp;</td><td>entry is represented by the tuple of the connection (sourceIP+sourcePort+destIP+destPort) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value,the</em>&nbsp;</td><td>associated value of an entry is a <a class="el" href="structconn__struct.html" title="The meta informations of a connection stored in the main Binary Tree.">conn_struct</a> structure </td></tr>
  </table>
</dl>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00892">clean()</a>, <a class="el" href="honeybrid_8c-source.html#l00272">close_conn_tree()</a>, <a class="el" href="tables_8c-source.html#l00876">free_conn()</a>, <a class="el" href="tables_8c-source.html#l00358">init_conn()</a>, and <a class="el" href="honeybrid_8c-source.html#l00449">init_variables()</a>.</p>

</div>
</div><p>
<a class="anchor" name="57f24b1e8646b9629e88a1b6ac586173"></a><!-- doxytag: member="tables.h::entrytoclean" ref="57f24b1e8646b9629e88a1b6ac586173" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GPtrArray* <a class="el" href="tables_8h.html#57f24b1e8646b9629e88a1b6ac586173">entrytoclean</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
pointer table for btree cleaning 
<p>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00892">clean()</a>, <a class="el" href="honeybrid_8c-source.html#l00272">close_conn_tree()</a>, and <a class="el" href="tables_8c-source.html#l00822">expire_conn()</a>.</p>

</div>
</div><p>
<a class="anchor" name="2c23bad51327c7ddd0c60a9753fecaf5"></a><!-- doxytag: member="tables.h::high_honeypot_addr" ref="2c23bad51327c7ddd0c60a9753fecaf5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GHashTable* <a class="el" href="tables_8h.html#2c23bad51327c7ddd0c60a9753fecaf5">high_honeypot_addr</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
global integer table that contains the addresses of the high_interaction honeypots (integer version) 
<p>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00672">test_honeypot_addr()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c78a111b39c6578a9368b4d9222debb2"></a><!-- doxytag: member="tables.h::high_redirection_table" ref="c78a111b39c6578a9368b4d9222debb2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GHashTable* <a class="el" href="tables_8h.html#c78a111b39c6578a9368b4d9222debb2">high_redirection_table</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
global hash table that contain the dynamic correspondance between HIH services et LIH services 
<p>

<p>Referenced by <a class="el" href="honeybrid_8c-source.html#l00206">close_hash()</a>, <a class="el" href="tables_8c-source.html#l00358">init_conn()</a>, <a class="el" href="tables_8c-source.html#l00727">lookup_honeypot_addr()</a>, and <a class="el" href="tables_8c-source.html#l00934">setup_redirection()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6504f1f2dd7c388151a2380811398a55"></a><!-- doxytag: member="tables.h::hihlock" ref="6504f1f2dd7c388151a2380811398a55" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GStaticRWLock <a class="el" href="tables_8h.html#6504f1f2dd7c388151a2380811398a55">hihlock</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
security writing lock for the dynamic high interaction redirection table 
<p>

</div>
</div><p>
<a class="anchor" name="ac37e3e4a8610192e1fa0a424ebf6a16"></a><!-- doxytag: member="tables.h::low_honeypot_addr" ref="ac37e3e4a8610192e1fa0a424ebf6a16" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GHashTable* <a class="el" href="tables_8h.html#ac37e3e4a8610192e1fa0a424ebf6a16">low_honeypot_addr</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
global integer table that contains the addresses of the low_interaction honeypots (integer version) 
<p>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00672">test_honeypot_addr()</a>.</p>

</div>
</div><p>
<a class="anchor" name="bea40e3b3ed9ec760b3c2dacb5b4e459"></a><!-- doxytag: member="tables.h::low_redirection_table" ref="bea40e3b3ed9ec760b3c2dacb5b4e459" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GHashTable* <a class="el" href="tables_8h.html#bea40e3b3ed9ec760b3c2dacb5b4e459">low_redirection_table</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
global hash table that contain the static correspondance between LIH services et HIH services 
<p>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00727">lookup_honeypot_addr()</a>.</p>

</div>
</div><p>
<a class="anchor" name="26611bf7bdbbe2211a3e5f7d66ad657a"></a><!-- doxytag: member="tables.h::mainpid" ref="26611bf7bdbbe2211a3e5f7d66ad657a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int <a class="el" href="tables_8h.html#26611bf7bdbbe2211a3e5f7d66ad657a">mainpid</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
the pid of the main program 
<p>

<p>Referenced by <a class="el" href="honeybrid_8c-source.html#l01009">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="993107ce3ba9b94d9eb3f712acea9034"></a><!-- doxytag: member="tables.h::module" ref="993107ce3ba9b94d9eb3f712acea9034" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GHashTable* <a class="el" href="tables_8h.html#993107ce3ba9b94d9eb3f712acea9034">module</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
global hash table to hold module paramaters 
<p>

<p>Referenced by <a class="el" href="decision__engine_8c-source.html#l00047">DE_build_subtree()</a>, <a class="el" href="honeybrid_8c-source.html#l00449">init_variables()</a>, and <a class="el" href="rules_8c-source.html#l01176">yyparse()</a>.</p>

</div>
</div><p>
<a class="anchor" name="a2939ade9165cd2467c80c6b284ef444"></a><!-- doxytag: member="tables.h::rwlock" ref="a2939ade9165cd2467c80c6b284ef444" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GStaticRWLock <a class="el" href="tables_8h.html#a2939ade9165cd2467c80c6b284ef444">rwlock</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
security writing lock for the Binary Tree 
<p>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00876">free_conn()</a>, <a class="el" href="tables_8c-source.html#l00358">init_conn()</a>, and <a class="el" href="honeybrid_8c-source.html#l00449">init_variables()</a>.</p>

</div>
</div><p>
<a class="anchor" name="5683838120bba13cc9fe85d804267dee"></a><!-- doxytag: member="tables.h::targets" ref="5683838120bba13cc9fe85d804267dee" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GPtrArray* <a class="el" href="tables_8h.html#5683838120bba13cc9fe85d804267dee">targets</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
global array of pointers to hold <a class="el" href="structtarget.html">target</a> structures 
<p>

<p>Referenced by <a class="el" href="honeybrid_8c-source.html#l00316">close_target()</a>, <a class="el" href="tables_8c-source.html#l00358">init_conn()</a>, <a class="el" href="honeybrid_8c-source.html#l00449">init_variables()</a>, and <a class="el" href="rules_8c-source.html#l01176">yyparse()</a>.</p>

</div>
</div><p>
<a class="anchor" name="75c2f1acbca6a769d31c693805c1c53f"></a><!-- doxytag: member="tables.h::threading" ref="75c2f1acbca6a769d31c693805c1c53f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="tables_8h.html#75c2f1acbca6a769d31c693805c1c53f">threading</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="tables_8c-source.html#l00892">clean()</a>, <a class="el" href="honeybrid_8c-source.html#l00159">close_thread()</a>, <a class="el" href="decision__engine_8c-source.html#l00423">DE_submit_packet()</a>, <a class="el" href="honeybrid_8c-source.html#l01009">main()</a>, and <a class="el" href="modules_8c-source.html#l00141">save_backup_handler()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Feb 9 10:46:08 2010 for honeybrid by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
